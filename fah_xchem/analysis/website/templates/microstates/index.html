{% extends "base.html" %}
{% set active_page = "microstates" %}
{% block content %}
<h3>Top 100 microstates</h3>
<h3>Microstates</h3>
<div class="my-3">See <a href="analysis.json">analysis.json</a> for complete results.</div>
<table class="table table-striped table-hover">
  <tr>
    <th>Rank</th>
    <th colspan="2">Microstate</th>
    <th>SMILES</th>
    <th>ΔΔG / kcal M<sup>-1</sup></th>
  </tr>
  {% for microstate in (microstates | selectattr("free_energy", "ne", None) | sort(attribute="free_energy.point"))[:100] %}
  <tr>
    <td class="rank">{{ loop.index }}</td>
    <td >{{ microstate.microstate.microstate_id | maybe_postera_link }}</td>
    <td class="thumbnail">
      <a href="molecule_images/{{ microstate.microstate.smiles | smiles_to_filename }}.svg">
        <img src="molecule_images/{{ microstate.microstate.smiles | smiles_to_filename }}.svg" alt="molecule" title="{{ microstate.microstate.microstate_id }}">
      </a>
    </td>
    <td class="smiles">{{  microstate.microstate.smiles }}</td>
    <td class="binding">
      {% if microstate.free_energy %}
      <span class="estimate">
        <span class="point">{{ (microstate.free_energy * KT_KCALMOL) | format_point }}</span>
        <span class="stderr"> ± {{ (microstate.free_energy * KT_KCALMOL) | format_stderr }}</span>
      </span>
      {% else %}
      no data
      {% endif %}
    </td>
  </tr>
  {% endfor %}
</table>
{% endblock %}
